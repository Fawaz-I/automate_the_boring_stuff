<html><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link href="../assets/inventwithpython.com/automate3workbook/style.css" rel="stylesheet" type="text/css" /><title>Automate the Boring Stuff with Python Workbook: Projects and Exercises to Sharpen Your Python Skills</title></head><body><style>.atbs-nav{display:flex;flex-wrap:wrap;gap:.5rem;align-items:center;justify-content:space-between;margin:1rem 0;padding:.7rem .8rem;border:1px solid #cfd8dc;border-radius:10px;background:#f6fbfd;font:14px/1.35 system-ui,-apple-system,sans-serif;}.atbs-nav-center{color:#455a64;font-weight:600;}.atbs-nav-link{text-decoration:none;color:#0b5b6b;background:#e6f3f7;border:1px solid #c7dfe7;border-radius:7px;padding:.42rem .55rem;display:inline-block;}.atbs-nav-link:hover{background:#d9edf3;}.atbs-nav-disabled{opacity:.55;cursor:not-allowed;}</style><nav class='atbs-nav' aria-label='Chapter pagination'><a class='atbs-nav-link' href='../book/chapter17.html' aria-label='Previous chapter'>&larr; Book Chapter 17</a><span class='atbs-nav-center'><a class='atbs-nav-link' href='../index.html'>Contents</a> Workbook Chapter 17</span><a class='atbs-nav-link' href='../book/chapter18.html' aria-label='Next chapter'>Book Chapter 18 &rarr;</a></nav>






<div class="calibre" id="calibre_link-25">
<section type="chapter" role="doc-chapter" aria-labelledby="ch17">
<h1 id="calibre_link-2729" type="title" class="h1ch"><span role="doc-pagebreak" id="calibre_link-2730" aria-label="119" class="calibre1"></span><span class="big">17</span><span class="break1"></span>PDF AND WORD DOCUMENTS</h1>
<p class="noindent-c">The PyPDF and Python-Docx packages can read and write PDF and Word documents, respectively, saving you from needing to edit files yourself. If you learn how to use these packages, you’ll be able to automate document tasks efficiently by writing quick and accurate Python programs.</p>
<aside type="sidebar" class="sidebar" aria-labelledby="side17" role="doc-example">
<section>
<h2 type="title" class="stitle" id="calibre_link-2731"><img class="inline" src="../assets/inventwithpython.com/automate3workbook/images/000000.jpg" alt="A simple drawing of a light bulb." /> LEARNING OBJECTIVES</h2>
<ul class="b-bullet">
<li class="bull">Parse PDF and Word documents to extract the text from them.</li>
<li class="bull">Understand the different features and purposes of the PDF and Word formats.</li>
<li class="bull">Edit the pages of PDF files, including by extracting the images from them.</li>
<li class="bull">Generate Word documents and apply text styles.</li>
</ul>
</section>
</aside>
<section>
<h2 id="calibre_link-210" type="title" class="h"><span role="doc-pagebreak" id="calibre_link-2732" aria-label="120" class="calibre1"></span><img class="inline" src="../assets/inventwithpython.com/automate3workbook/images/000005.jpg" alt="A grey circle with a white question mark at the center" /> Practice Questions</h2>
<p class="noindent">The following questions test your ability to read and modify PDF and Word documents using Python.</p>
<section>
<h3 id="calibre_link-211" type="title" class="h1">PDF Documents</h3>
<p class="noindent"><i class="calibre5">PDF</i> stands for <i class="calibre5">Portable Document Format</i> and uses the <i class="calibre5">.pdf</i> file extension. Although PDFs support many features, the questions in this section will focus on three common tasks: extracting a document’s text content, extracting its images, and crafting new PDFs from existing documents.</p>
<ol class="order">
<li class="calibre15"><p class="number"><a href="#calibre_link-1083" id="calibre_link-2217" class="calibre6">1</a>. What do you pass to the <span class="literal">pypdf.PdfReader()</span> function to open a PDF file?</p></li>
<li class="calibre15"><p class="number"><a href="#calibre_link-1084" id="calibre_link-2218" class="calibre6">2</a>. Where can you find the individual <span class="literal">Page</span> objects of a <span class="literal">PdfReader</span> object?</p></li>
<li class="calibre15"><p class="number"><a href="#calibre_link-1085" id="calibre_link-2219" class="calibre6">3</a>. Write the code for a function named <span class="literal">get_num_pages()</span> that accepts a PDF’s filename as a string and returns the number of pages it has.</p></li>
<li class="calibre15"><p class="number"><a href="#calibre_link-1086" id="calibre_link-2220" class="calibre6">4</a>. Which method of <span class="literal">Page</span> objects extracts text from a PDF?</p></li>
<li class="calibre15"><p class="number"><a href="#calibre_link-1087" id="calibre_link-2221" class="calibre6">5</a>. Write code that extracts the text of <a href="#calibre_link-1088" class="calibre6">page 2</a> of a PDF file. Assume a variable named <span class="literal">reader</span> contains the <span class="literal">PdfReader</span> object.</p></li>
<li class="calibre15"><p class="number"><a href="#calibre_link-1089" id="calibre_link-2222" class="calibre6">6</a>. Which <span class="literal">pdfminer</span> function extracts text from a PDF file, and which argument must you pass to this function?</p></li>
<li class="calibre15"><p class="number"><a href="#calibre_link-1090" id="calibre_link-2223" class="calibre6">7</a>. How can you automatically clean up the extracted text strings from a PDF in a way that respects the context of the text?</p></li>
<li class="calibre15"><p class="number"><a href="#calibre_link-1091" id="calibre_link-2224" class="calibre6">8</a>. Which <span class="literal">pypdf</span> function lets you create new PDF files?</p></li>
<li class="calibre15"><p class="number"><a href="#calibre_link-1092" id="calibre_link-2225" class="calibre6">9</a>. Can the PyPDF package write arbitrary text to a PDF file in the same way that Python can write arbitrary text to a <i class="calibre5">.txt</i> file?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1093" id="calibre_link-2226" class="calibre6">10</a>. Can you rotate a page in a PDF by 45 degrees using <span class="literal">pydpdf</span> or <span class="literal">pdfminer</span>?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1094" id="calibre_link-2227" class="calibre6">11</a>. Write code that creates a new file named <i class="calibre5">rotated.pdf</i> that has the contents of <i class="calibre5">example.pdf</i>, but rotated clockwise by 90 degrees.</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1095" id="calibre_link-2228" class="calibre6">12</a>. What <span class="literal">Page</span> method allows you to add a watermark to a page?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1096" id="calibre_link-2229" class="calibre6">13</a>. What <span class="literal">PdfWriter</span> method adds a blank page to the end of a PDF document?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1097" id="calibre_link-2230" class="calibre6">14</a>. Write the code to insert a blank page as the new <a href="#calibre_link-1098" class="calibre6">page 3</a> in a PDF document. Assume a variable named <span class="literal">writer</span> contains the <span class="literal">PdfWriter</span> object.</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1099" id="calibre_link-2231" class="calibre6">15</a>. Which modern encryption algorithm do experts recommend you use to encrypt your PDF files?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1100" id="calibre_link-2232" class="calibre6">16</a>. Why would <span class="literal">elephant</span> be a poor password to use to encrypt your PDF files?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1101" id="calibre_link-2233" class="calibre6">17</a>. What two types of passwords do PDF files support for encryption?</p></li>
</ol>
</section>
<section>
<h3 id="calibre_link-212" type="title" class="h1"><span role="doc-pagebreak" id="calibre_link-2733" aria-label="121" class="calibre1"></span>Word Documents</h3>
<p class="noindent">Python can create and modify Microsoft Word documents, which have the <i class="calibre5">.docx</i> file extension, with the Python-Docx package. Compared to plaintext files, <i class="calibre5">.docx</i> files have many structural elements, which Python-Docx represents using three different data types. At the highest level, a <span class="literal">Document</span> object represents the entire document. The <span class="literal">Document</span> object contains a list of <span class="literal">Paragraph</span> objects for the paragraphs in the document. (A new paragraph begins whenever the user presses <span class="smallcaps">enter</span> or <span class="smallcaps">return</span> in a Word document.) Each of these <span class="literal">Paragraph</span> objects contains a list of one or more <span class="literal">Run</span> objects.</p>
<p class="indent">Answer the following questions about Word documents and the Python-Docx package. Where relevant, assume that a variable named <span class="literal">doc</span> stores the <span class="literal">Document</span> object.</p>
<ol class="order">
<li class="calibre15"><p class="number1"><a href="#calibre_link-1102" id="calibre_link-2234" class="calibre6">18</a>. Write code that opens a file named <i class="calibre5">demo.docx</i> and stores the <span class="literal">Document</span> object in a variable named <span class="literal">doc</span>.</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1103" id="calibre_link-2235" class="calibre6">19</a>. What code would get a string value of the text in the second paragraph of a <span class="literal">Document</span> object?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1104" id="calibre_link-2236" class="calibre6">20</a>. What code would retrieve the number of paragraphs in a <span class="literal">Document</span> object?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1105" id="calibre_link-2237" class="calibre6">21</a>. True or false: <span class="literal">Document</span> objects contain <span class="literal">Paragraph</span> objects, which in turn contain <span class="literal">Run</span> objects.</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1106" id="calibre_link-2238" class="calibre6">22</a>. True or false: To italicize some text in a paragraph and bold some other text in that same paragraph, you must set the <span class="literal">bold</span> and <span class="literal">italic</span> attributes of the <span class="literal">Paragraph</span> object to <span class="literal">True</span>.</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1107" id="calibre_link-2239" class="calibre6">23</a>. Which of the following have a text attribute: <span class="literal">Document</span> objects, <span class="literal">Paragraph</span> objects, or <span class="literal">Run</span> objects?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1108" id="calibre_link-2240" class="calibre6">24</a>. To what three values can you set attributes of <span class="literal">Run</span> objects such as <span class="literal">bold</span>, <span class="literal">italic</span>, and <span class="literal">strike</span>, and what do these values mean?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1109" id="calibre_link-2241" class="calibre6">25</a>. What code adds a paragraph to a document with the text “Hello, world!” in the built-in Title style?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1110" id="calibre_link-2242" class="calibre6">26</a>. What kind of objects have the <span class="literal">add_paragraph()</span> method?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1111" id="calibre_link-2243" class="calibre6">27</a>. What kind of objects have the <span class="literal">add_run()</span> method?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1112" id="calibre_link-2244" class="calibre6">28</a>. Create a blank <i class="calibre5">.docx</i> document in either Microsoft 365 or another application. Then, open it with Python-Docx. How many <span class="literal">Paragraph</span> objects does this empty document contain? How many <span class="literal">Run</span> objects does this empty document contain?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1113" id="calibre_link-2245" class="calibre6">29</a>. Write a program that creates a Word document named <i class="calibre5">millionstars.docx</i> that has exactly one million asterisks; no more, no less.</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1114" id="calibre_link-2246" class="calibre6">30</a>. Write a program that creates a Word document named <i class="calibre5">countdown.docx</i> that counts down from 1,000 to 0, with one number per paragraph.</p></li>
</ol>
</section>
</section>
<section>
<h2 id="calibre_link-213" type="title" class="h"><span role="doc-pagebreak" id="calibre_link-2734" aria-label="122" class="calibre1"></span><img class="inline" src="../assets/inventwithpython.com/automate3workbook/images/000002.jpg" alt="A simple drawing of a sharpened pencil." /> Practice Projects</h2>
<p class="noindent">Each of these projects re-creates a feature that is already available in a PDF or word processing app, but implementing them as Python code lets you automatically process hundreds or thousands of documents.</p>
<section>
<h3 id="calibre_link-214" type="title" class="h1">PDF Document Word Counter</h3>
<p class="noindent">Write a function named <span class="literal">pdf_word_count(pdf_filename)</span> that opens the given PDF file, extracts the text from it, and returns a word count of the document. To calculate the word count, call the <span class="literal">split()</span> method on the text. Different PDF files and packages may produce different word counts, but a rough value suffices for the purposes of this project.</p>
</section>
<section>
<h3 id="calibre_link-215" type="title" class="h1">Searching All PDFs in a Folder</h3>
<p class="noindent">While PDF apps allow you to search for text in a PDF file with <span class="smallcaps">ctrl</span>-F, most won’t allow you to search an entire folder of files all at once. Write a program that extracts all the text from the PDF, searches for some given text, and returns each instance where it’s found.</p>
<p class="indent">Define a function named <span class="literal">search_all_PDFs(text, folder='.', case_sensitive</span><span class="literal">=False)</span> that searches for the <span class="literal">text</span> string argument in PDF files in the folder named <span class="literal">folder</span>. The <span class="literal">case_sensitive</span> parameter should have a default value of <span class="literal">False</span>, but if passed <span class="literal">True</span>, the function should report only matches in the same case as <span class="literal">text</span>.</p>
<p class="indent">The function should return a list of strings formatted as <span class="literal">'In {filename} on page {page_number}'</span>.</p>
</section>
<section>
<h3 id="calibre_link-216" type="title" class="h1">Word Document Logger for Guess the Number</h3>
<p class="noindent">Your boss wants to see the output of the Guess the Number game in <a href="#calibre_link-11" class="calibre6">Chapter 3</a> of <i class="calibre5">Automate the Boring Stuff with Python</i>. They have the peculiar demand that the text be presented in a Word document. Their personal assistant will print the Word document, add it to a pile on their desk, and throw it away next week, unread.</p>
<p class="indent">Take the Guess the Number game and add code to it to generate a <i class="calibre5">guessWordLog.docx</i> file. You can find this source code in the downloadable resources link at <i class="calibre5"><a href="https://nostarch.com/automate-boring-stuff-python-3rd-edition" class="calibre6">https://nostarch.com/automate-boring-stuff-python-3rd-edition</a></i>. After each <span class="literal">print()</span> function call in the original code, insert code that writes the printed text to the Word document as a new paragraph. For example, your code could contain something like this:</p>
<pre class="pre">print('I am thinking of a number between 1 and 20.')
doc.add_paragraph('I am thinking of a number between 1 and 20.')</pre>
<p class="indent">Follow every call to <span class="literal">input()</span> with code that adds the player’s input to the Word document as well. If the <i class="calibre5">guessWordLog.docx</i> file already exists, your program should add the new paragraphs to it, after the existing text.</p>
<p class="indent">Save this program in a file named <i class="calibre5">guessWordLog.py</i>.</p>
</section>
<section>
<h3 id="calibre_link-217" type="title" class="h1"><span role="doc-pagebreak" id="calibre_link-2735" aria-label="123" class="calibre1"></span>Converting Text Files to Word Documents</h3>
<p class="noindent">Write a function named <span class="literal">str_to_docx(text, word_filename)</span>. The <span class="literal">text</span> argument should be a multiline string of contents to write to a new Word document, while the <span class="literal">word_filename</span> argument should be a string representing the Word document’s filename. Each line in the multiline string should become its own <span class="literal">Paragraph</span> object in the Word file.</p>
<p class="indent">Next, write code for a program that calls <span class="literal">str_to_docx()</span> to create Word documents for every <i class="calibre5">.txt</i> file in the current working directory. The program should add the <i class="calibre5">.docx</i> extension to the end of a file, saving the contents of <i class="calibre5">spam.txt</i> as a file named <i class="calibre5">spam.txt.docx</i>, for example.</p>
<p class="indent">Save this program in a file named <i class="calibre5">txt2docx.py</i>.</p>
</section>
<section>
<h3 id="calibre_link-218" type="title" class="h1">Bolding Words in a Word Document</h3>
<p class="noindent">Write a function named <span class="literal">bold_words(filename, word)</span> that opens the Word document in the <span class="literal">filename</span> file and formats every occurrence of the string in <span class="literal">word</span> as bold text. The function shouldn’t modify the original document’s filename; instead, it should write the results to a file with <i class="calibre5">.bold.docx</i> appended to the end. For example, calling <span class="literal">bold_words('demo.docx', 'hello')</span> would create a <i class="calibre5">demo.docx.bold.docx</i> file in which every case-sensitive match of <span class="literal">'hello'</span> has been bolded. The original Word document should remain the same.</p>
<p class="indent">For simplicity, you may assume that the original Word document has no styling in it and uses only the default font. Your <span class="literal">bold_words()</span> function should construct the new Word document by creating <span class="literal">Paragraph</span> objects with separate <span class="literal">Run</span> objects that each have the <span class="literal">bold</span> attribute set to <span class="literal">True</span> or <span class="literal">False</span>. For example, if <i class="calibre5">demo.docx</i> contained a single paragraph with the text “Say hello to Alice,” calling <span class="literal">bold_words ('demo.docx', 'hello')</span> would create a Word document with one <span class="literal">Paragraph</span> object and three <span class="literal">Run</span> objects for the text <span class="literal">'Say '</span>, <span class="literal">'hello'</span>, and <span class="literal">' to Alice'</span>. The middle <span class="literal">Run</span> object containing <span class="literal">'hello'</span> would be set to bold.</p>
<p class="indent">Save this program in a file named <i class="calibre5">boldWords.py</i>.<span role="doc-pagebreak" id="calibre_link-2736" aria-label="124"></span></p>
</section>
</section>
</section>
</div>







<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"8bd877e77db3400e83e36e899a2ab1fd","r":1,"server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<style>.atbs-nav{display:flex;flex-wrap:wrap;gap:.5rem;align-items:center;justify-content:space-between;margin:1rem 0;padding:.7rem .8rem;border:1px solid #cfd8dc;border-radius:10px;background:#f6fbfd;font:14px/1.35 system-ui,-apple-system,sans-serif;}.atbs-nav-center{color:#455a64;font-weight:600;}.atbs-nav-link{text-decoration:none;color:#0b5b6b;background:#e6f3f7;border:1px solid #c7dfe7;border-radius:7px;padding:.42rem .55rem;display:inline-block;}.atbs-nav-link:hover{background:#d9edf3;}.atbs-nav-disabled{opacity:.55;cursor:not-allowed;}</style><nav class='atbs-nav' aria-label='Chapter pagination'><a class='atbs-nav-link' href='../book/chapter17.html' aria-label='Previous chapter'>&larr; Book Chapter 17</a><span class='atbs-nav-center'><a class='atbs-nav-link' href='../index.html'>Contents</a> Workbook Chapter 17</span><a class='atbs-nav-link' href='../book/chapter18.html' aria-label='Next chapter'>Book Chapter 18 &rarr;</a></nav></body></html>