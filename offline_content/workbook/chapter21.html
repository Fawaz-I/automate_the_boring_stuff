<html><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link href="../assets/inventwithpython.com/automate3workbook/style.css" rel="stylesheet" type="text/css" /><title>Automate the Boring Stuff with Python Workbook: Projects and Exercises to Sharpen Your Python Skills</title></head><body><style>.atbs-nav{display:flex;flex-wrap:wrap;gap:.5rem;align-items:center;justify-content:space-between;margin:1rem 0;padding:.7rem .8rem;border:1px solid #cfd8dc;border-radius:10px;background:#f6fbfd;font:14px/1.35 system-ui,-apple-system,sans-serif;}.atbs-nav-center{color:#455a64;font-weight:600;}.atbs-nav-link{text-decoration:none;color:#0b5b6b;background:#e6f3f7;border:1px solid #c7dfe7;border-radius:7px;padding:.42rem .55rem;display:inline-block;}.atbs-nav-link:hover{background:#d9edf3;}.atbs-nav-disabled{opacity:.55;cursor:not-allowed;}</style><nav class='atbs-nav' aria-label='Chapter pagination'><a class='atbs-nav-link' href='../book/chapter21.html' aria-label='Previous chapter'>&larr; Book Chapter 21</a><span class='atbs-nav-center'><a class='atbs-nav-link' href='../index.html'>Contents</a> Workbook Chapter 21</span><a class='atbs-nav-link' href='../book/chapter22.html' aria-label='Next chapter'>Book Chapter 22 &rarr;</a></nav>






<div class="calibre" id="calibre_link-29">
<section type="chapter" role="doc-chapter" aria-labelledby="ch21">
<h1 id="calibre_link-2759" type="title" class="h1ch"><span role="doc-pagebreak" id="calibre_link-2760" aria-label="141" class="calibre1"></span><span class="big">21</span><span class="break1"></span>MAKING GRAPHS AND MANIPULATING IMAGES</h1>
<p class="noindent-c">A picture is worth a thousand words, and your code can handle high-resolution image files just as it can any other form of data. The third-party Pillow package has several functions for editing images and drawing lines and text with the precision and speed of automated scripts. To generate line graphs, bar graphs, scatter plots, and pie charts, you can use Matplotlib, a popular library for making professional-looking graphs.</p>
<aside type="sidebar" class="sidebar" aria-labelledby="side21" role="doc-example">
<section>
<h2 type="title" class="stitle" id="calibre_link-2761"><img class="inline" src="../assets/inventwithpython.com/automate3workbook/images/000000.jpg" alt="A simple drawing of a light bulb." /> LEARNING OBJECTIVES</h2>
<ul class="b-bullet">
<li class="bull">Understand how computers store images, pixels, and colors.</li>
<li class="bull">Perform basic image editing by resizing, cropping, and rotating images with Pillow.</li>
<li class="bull">Draw shapes and text onto images, or overlay images on top of each other.</li>
<li class="bull">Copy and paste images to the clipboard.</li>
<li class="bull">Generate graphs using Matplotlib.</li>
</ul>
</section>
</aside>
<section>
<h2 id="calibre_link-242" type="title" class="h"><span role="doc-pagebreak" id="calibre_link-2762" aria-label="142" class="calibre1"></span><img class="inline" src="../assets/inventwithpython.com/automate3workbook/images/000005.jpg" alt="A grey circle with a white question mark at the center" /> Practice Questions</h2>
<p class="noindent">These questions test your knowledge of the Pillow library, image file concepts in general, and graphing with Matplotlib.</p>
<section>
<h3 id="calibre_link-243" type="title" class="h1">Computer Image Fundamentals</h3>
<p class="noindent">Computer programs often represent a color in an image as an <i class="calibre5">RGBA value</i>, a group of numbers that specify the amount of red, green, blue, and alpha (transparency) to include. Image pixels are addressed with x- and y-coordinates, which, respectively, specify a pixel’s horizontal and vertical locations.</p>
<ol class="order">
<li class="calibre15"><p class="number"><a href="#calibre_link-1230" id="calibre_link-2362" class="calibre6">1</a>. What color is <span class="literal">(0, 255, 0, 0)</span>?</p></li>
<li class="calibre15"><p class="number"><a href="#calibre_link-1231" id="calibre_link-2363" class="calibre6">2</a>. What does the <i class="calibre5">A</i> in <i class="calibre5">RGBA</i> represent?</p></li>
<li class="calibre15"><p class="number"><a href="#calibre_link-1232" id="calibre_link-2364" class="calibre6">3</a>. What function can you call to get the RGBA value of the color “chocolate”?</p></li>
<li class="calibre15"><p class="number"><a href="#calibre_link-1233" id="calibre_link-2365" class="calibre6">4</a>. What code returns a list of all the color names in the Pillow library?</p></li>
<li class="calibre15"><p class="number"><a href="#calibre_link-1234" id="calibre_link-2366" class="calibre6">5</a>. What are the x- and y-coordinates of the origin?</p></li>
<li class="calibre15"><p class="number"><a href="#calibre_link-1235" id="calibre_link-2367" class="calibre6">6</a>. In which corner of an image is the origin?</p></li>
<li class="calibre15"><p class="number"><a href="#calibre_link-1236" id="calibre_link-2368" class="calibre6">7</a>. What is the RGBA tuple for the color purple?</p></li>
<li class="calibre15"><p class="number"><a href="#calibre_link-1237" id="calibre_link-2369" class="calibre6">8</a>. <span class="literal">(255, 255, 255, 255)</span> is the RGBA tuple for what color?</p></li>
<li class="calibre15"><p class="number"><a href="#calibre_link-1238" id="calibre_link-2370" class="calibre6">9</a>. <span class="literal">(0, 0, 0, 255)</span> is the RGBA tuple for what color?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1239" id="calibre_link-2371" class="calibre6">10</a>. In a 100-pixel-wide and 100-pixel-tall image, what is the coordinate of the pixel in the bottom-right corner?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1240" id="calibre_link-2372" class="calibre6">11</a>. What is a box tuple in the context of the Pillow library?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1241" id="calibre_link-2373" class="calibre6">12</a>. How can you calculate the width of the box from the data in a box tuple?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1242" id="calibre_link-2374" class="calibre6">13</a>. What are the width and height of a <span class="literal">(5, 20, 10, 30)</span> box tuple?</p></li>
</ol>
</section>
<section>
<h3 id="calibre_link-244" type="title" class="h1">Manipulating Images with Pillow</h3>
<p class="noindent">An <span class="literal">Image</span> object has several useful attributes that give you basic information about the image file from which it was loaded: its width and height, the filename, and the graphics format. The object’s methods allow you to crop, rotate, resize, extract, and duplicate portions of the image.</p>
<ol class="order">
<li class="calibre15"><p class="number1"><a href="#calibre_link-1243" id="calibre_link-2375" class="calibre6">14</a>. You do not run <span class="literal">import pillow</span> to import Pillow. What instruction do you run?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1244" id="calibre_link-2376" class="calibre6">15</a>. Can Pillow read images in the <i class="calibre5">.png</i>, <i class="calibre5">.jpg</i>, and <i class="calibre5">.gif</i> formats?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1245" id="calibre_link-2377" class="calibre6">16</a>. What does the <span class="literal">Image.open()</span> function return?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1246" id="calibre_link-2378" class="calibre6">17</a>. <span role="doc-pagebreak" id="calibre_link-2763" aria-label="143"></span>What does the <span class="literal">show()</span> method do?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1247" id="calibre_link-2379" class="calibre6">18</a>. What does the following code do: <span class="literal">Image.new('RGBA', (100,100), 'purple').show()</span>?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1248" id="calibre_link-2380" class="calibre6">19</a>. Say you have an image named <i class="calibre5">zophie.png</i>. How can you find the width and height of this image?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1249" id="calibre_link-2381" class="calibre6">20</a>. Which is correct: <span class="literal">im.crop(335, 345, 565, 560)</span> or <span class="literal">im.crop((335, 345, 565, 560))</span>?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1250" id="calibre_link-2382" class="calibre6">21</a>. Does the method call <span class="literal">im.crop((335, 345, 565, 560))</span> change the size of the <span class="literal">Image</span> object in <span class="literal">im</span>?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1251" id="calibre_link-2383" class="calibre6">22</a>. What does the <span class="literal">copy()</span> method do?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1252" id="calibre_link-2384" class="calibre6">23</a>. Does <span class="literal">copy()</span> take a box tuple argument to specify which portion of the image it should copy?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1253" id="calibre_link-2385" class="calibre6">24</a>. What does the code <span class="literal">cat_im.paste(face_im, (0, 0))</span> do?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1254" id="calibre_link-2386" class="calibre6">25</a>. Will the function call <span class="literal">cat_im.paste(face_im, (0, 0))</span> correctly paste pixels with transparency, or will these pixels show up as opaque white pixels?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1255" id="calibre_link-2387" class="calibre6">26</a>. If the <span class="literal">Image</span> object in <span class="literal">im</span> contains a 100×100 image, the method call <span class="literal">im.resize((2.0, 2.0))</span> doesn’t resize the image to double the width and height. What method call will do this?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1256" id="calibre_link-2388" class="calibre6">27</a>. Does the method call <span class="literal">im.resize((100, 100))</span> change the size of the <span class="literal">Image</span> object in <span class="literal">im</span>?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1257" id="calibre_link-2389" class="calibre6">28</a>. What method call returns a new <span class="literal">Image</span> object that is a horizontally flipped version of an <span class="literal">Image</span> object in an <span class="literal">im</span> variable?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1258" id="calibre_link-2390" class="calibre6">29</a>. What method call returns a new <span class="literal">Image</span> object that is a vertically flipped version of an <span class="literal">Image</span> object in an <span class="literal">im</span> variable?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1259" id="calibre_link-2391" class="calibre6">30</a>. Is horizontally flipping an image the same thing as rotating the image 180 degrees?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1260" id="calibre_link-2392" class="calibre6">31</a>. If you rotate a 200×100 image by 90 degrees (and pass <span class="literal">expand=True</span> to the <span class="literal">rotate()</span> method call), how big is the rotated image?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1261" id="calibre_link-2393" class="calibre6">32</a>. If you rotate a 200×100 image by 180 degrees (and pass <span class="literal">expand=True</span> to the <span class="literal">rotate()</span> method call), how big is the rotated image?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1262" id="calibre_link-2394" class="calibre6">33</a>. If the <span class="literal">Image</span> object in <span class="literal">im</span> is 200×100 in size, how big is the <span class="literal">Image</span> object returned by <span class="literal">im.rotate(45)</span>?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1263" id="calibre_link-2395" class="calibre6">34</a>. Is the <span class="literal">Image</span> object returned by <span class="literal">im.rotate(45, expand=True)</span> bigger, smaller, or the same size as the <span class="literal">Image</span> object in <span class="literal">im</span>?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1264" id="calibre_link-2396" class="calibre6">35</a>. What method returns the color of a single pixel of an <span class="literal">Image</span> object?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1265" id="calibre_link-2397" class="calibre6">36</a>. Does <span class="literal">im.putpixel((50, 100), (255, 0, 0))</span> return a new <span class="literal">Image</span> object with the changed pixel?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1266" id="calibre_link-2398" class="calibre6">37</a>. <span role="doc-pagebreak" id="calibre_link-2764" aria-label="144"></span>What does the following code draw?</p>
<pre class="calibre16">from PIL import Image
im = Image.new('RGBA', (100, 100), 'red')
for x in range(10, 90):
&nbsp;&nbsp;&nbsp;&nbsp;for y in range(10, 90):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;im.putpixel((x, y), (0, 0, 255, 255))
im.show()</pre></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1267" id="calibre_link-2399" class="calibre6">38</a>. Write the code to draw a 100×100 image that is green on the top half and yellow on the bottom half. Hint: The RGBA tuple for green is <span class="literal">(0, 255, 0, 255)</span>, and the RGBA tuple for yellow is <span class="literal">(255, 255, 0, 255)</span>. Your program should call the <span class="literal">show()</span> method to display the image.</p></li>
</ol>
</section>
<section>
<h3 id="calibre_link-245" type="title" class="h1">Drawing on Images</h3>
<p class="noindent">Pillow’s <span class="literal">ImageDraw</span> module lets you treat image files as canvases to draw on with code. You can change individual pixels as well as draw shapes such as rectangles, circles, and lines.</p>
<ol class="order">
<li class="calibre15"><p class="number1"><a href="#calibre_link-1268" id="calibre_link-2400" class="calibre6">39</a>. What <span class="literal">import</span> statement must you run before drawing shapes on <span class="literal">Image</span> objects?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1269" id="calibre_link-2401" class="calibre6">40</a>. What code returns an <span class="literal">ImageDraw</span> object for an <span class="literal">Image</span> object stored in a variable named <span class="literal">im</span>?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1270" id="calibre_link-2402" class="calibre6">41</a>. What method draws a circle?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1271" id="calibre_link-2403" class="calibre6">42</a>. What method draws a square?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1272" id="calibre_link-2404" class="calibre6">43</a>. How many lines does this method call draw: <span class="literal">draw.line([10, 10, 20, 20, 40, 60])</span>?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1273" id="calibre_link-2405" class="calibre6">44</a>. You cannot draw a diamond shape that looks like a square rotated 45 degrees with the <span class="literal">rectangle()</span> method. Which method can draw this diamond shape?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1274" id="calibre_link-2406" class="calibre6">45</a>. What do each of the three arguments mean in <span class="literal">draw.text((20, 150), 'Hello', fill='purple')</span>?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1275" id="calibre_link-2407" class="calibre6">46</a>. What font does the method call <span class="literal">draw.text((20, 150), 'Hello', fill='purple')</span> use to draw the text?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1276" id="calibre_link-2408" class="calibre6">47</a>. Say you call the <span class="literal">ImageFont.truetype()</span> function on a nonexistent font, as in <span class="literal">ImageFont.truetype('no_such_font.ttf', 32)</span>. What error does this raise?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1277" id="calibre_link-2409" class="calibre6">48</a>. Write code that creates a 100×100 image of black text on a white background. The text should read “Hello”; then, resize the image to 1,000×1,000.</p></li>
</ol>
</section>
<section>
<h3 id="calibre_link-246" type="title" class="h1"><span role="doc-pagebreak" id="calibre_link-2765" aria-label="145" class="calibre1"></span>Copying and Pasting Images to the Clipboard</h3>
<p class="noindent">Just as the third-party <span class="literal">pyperclip</span> module allows you to copy-and-paste text strings to the clipboard, the <span class="literal">pyperclipimg</span> module can copy-and-paste Pillow <span class="literal">Image</span> objects. By putting images on and getting images from the clipboard, you can enable users to quickly input and output image data without first saving it to an image file.</p>
<ol class="order">
<li class="calibre15"><p class="number1"><a href="#calibre_link-1278" id="calibre_link-2410" class="calibre6">49</a>. Does <span class="literal">pyperclipimg</span> require you to also install Pillow?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1279" id="calibre_link-2411" class="calibre6">50</a>. What does the code <span class="literal">pyperclipimg.paste().show()</span> do?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1280" id="calibre_link-2412" class="calibre6">51</a>. What data type does the <span class="literal">pyperclipimg.paste()</span> function return if there is an image on the clipboard?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1281" id="calibre_link-2413" class="calibre6">52</a>. What value does the <span class="literal">pyperclipimg.paste()</span> function return if there is text on the clipboard?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1282" id="calibre_link-2414" class="calibre6">53</a>. What does the code <span class="literal">pyperclipimg.copy(pyperclipimg.paste().resize((100, 100)))</span> do?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1283" id="calibre_link-2415" class="calibre6">54</a>. What does the code <span class="literal">pyperclipimg.paste().save('contents.png')</span> do?</p></li>
</ol>
</section>
<section>
<h3 id="calibre_link-247" type="title" class="h1">Creating Graphs with Matplotlib</h3>
<p class="noindent">Drawing your own graphs using Pillow’s <span class="literal">ImageDraw</span> module is possible but would require a lot of work. The Matplotlib library can create a wide variety of graphs for use in professional publications.</p>
<ol class="order">
<li class="calibre15"><p class="number1"><a href="#calibre_link-1284" id="calibre_link-2416" class="calibre6">55</a>. What is the usual convention for importing Matplotlib? (Hint: It uses the <span class="literal">as</span> keyword in the <span class="literal">import</span> statement.)</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1285" id="calibre_link-2417" class="calibre6">56</a>. How many points are on the plot created by <span class="literal">plt.plot([10, 20, 30], [10, 5, 40])</span>?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1286" id="calibre_link-2418" class="calibre6">57</a>. Does the plot created by <span class="literal">plt.plot([10, 20, 30], [10, 5, 40])</span> include points connected by lines, or just individual points?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1287" id="calibre_link-2419" class="calibre6">58</a>. What is the name of the kind of plot that has individual points but no lines connecting them?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1288" id="calibre_link-2420" class="calibre6">59</a>. What method call saves the plot as an image file named <i class="calibre5">plot.png</i>?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1289" id="calibre_link-2421" class="calibre6">60</a>. What are the two arguments to the <span class="literal">plt.bar()</span> function?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1290" id="calibre_link-2422" class="calibre6">61</a>. What functions add an x-axis label and a y-axis label?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1291" id="calibre_link-2423" class="calibre6">62</a>. What does <span class="literal">plt.grid(True)</span> do?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1292" id="calibre_link-2424" class="calibre6">63</a>. What code displays an interactive preview window of a plot?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1293" id="calibre_link-2425" class="calibre6">64</a>. <span role="doc-pagebreak" id="calibre_link-2766" aria-label="146"></span>What does the following code do?</p>
<pre class="calibre16">import matplotlib.pyplot as plt
slices = [80, 20]
labels = ['Part that looks like Pacman', 'Part that does not
look like Pacman']
plt.pie(slices, labels=labels)
plt.show()</pre></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1294" id="calibre_link-2426" class="calibre6">65</a>. What code adds the text “The plot thickens” to the top of your plot?</p></li>
</ol>
</section>
</section>
<section>
<h2 id="calibre_link-248" type="title" class="h"><img class="inline" src="../assets/inventwithpython.com/automate3workbook/images/000002.jpg" alt="A simple drawing of a sharpened pencil." /> Practice Projects</h2>
<p class="noindent">In the following projects, you’ll create an image of a snowpal, generate rainbow flags, and build a clipboard logger.</p>
<section>
<h3 id="calibre_link-249" type="title" class="h1">Snowpal Image</h3>
<p class="noindent">Use Pillow to create an image of a wintery snowpal according to the following specifications:</p>
<ul class="bullet">
<li class="bull">The image size should be 1,000×1,000.</li>
<li class="bull">The top of the background should be a blue sky, and the bottom should be a white, snow-covered ground.</li>
<li class="bull">The snowpal’s body should consist of three black circles or ellipses with a white fill.</li>
<li class="bull">The snowpal should have a top hat made from two black rectangles.</li>
<li class="bull">The snowpal should have left and right arms made from two lines.</li>
</ul>
<p class="indent">Aside from these requirements, you may make your image look however you want. You can add a face or buttons, use any shade of blue for the sky, add falling snowflakes to the background, create ears and whiskers to make a snowcat, or put the code in a loop to draw multiple snowpals.</p>
<p class="indent">At the end of the program, call the <span class="literal">show()</span> method to display your snowpal. If you write this method call code first at the bottom of your program, you can create your program in pieces and run it to see how the image is coming together.</p>
<p class="indent">Save this program in a file named <i class="calibre5">snowpalImage.py</i>.</p>
</section>
<section>
<h3 id="calibre_link-250" type="title" class="h1">Rainbow Flag Image Generator</h3>
<p class="noindent">The rainbow flag is a simple image consisting of six horizontal stripes in a rectangle. Let’s create a function, <span class="literal">create_rainbow_flag(width, height)</span>, that takes a <span class="literal">width</span> and <span class="literal">height</span> parameter and generates a custom-sized rainbow flag. The colors to use, from top to bottom, are red, orange, yellow, green, blue, and purple.</p>
<p class="indent">The horizontal stripes should have x-coordinates that always range from <span class="literal">0</span> to <span class="literal">width - 1</span>, while the y-coordinates will vary but should always be <span class="literal">int(height / 6)</span> tall. The exception is the purple stripe at the bottom, which always goes down to <span class="literal">height - 1</span> to cover the entire image. Make sure your flag doesn’t have gaps in between the stripes.</p>
<p class="indent"><span role="doc-pagebreak" id="calibre_link-2767" aria-label="147"></span>For example, if you call <span class="literal">create_rainbow_flag(640, 480)</span>, your code should produce an <span class="literal">Image</span> object that is 640 pixels wide and 480 pixels tall. You can call the <span class="literal">show()</span> or <span class="literal">save()</span> method on this <span class="literal">Image</span> object to view the rainbow flag. Test your function by calling it with various arguments, and make sure the resulting image is the correct size.</p>
</section>
<section>
<h3 id="calibre_link-251" type="title" class="h1">Clipboard Image Recorder</h3>
<p class="noindent">In <a href="#calibre_link-20" class="calibre6">Chapter 12</a> of <i class="calibre5">Automate the Boring Stuff with Python</i>, we created a clipboard recording program that logged all text that appeared on the clipboard. Let’s do the same thing here, but instead of logging text, your program will record any images copied to the clipboard. Such a program can speed up your workflow if you’re, say, trying to download multiple images on a website but don’t want to fill out Save As dialogs for each one.</p>
<p class="indent">You can use the <i class="calibre5">cliprec.py</i> program’s source code as a starting point. You can find this program in the downloadable resources at <i class="calibre5"><a href="https://nostarch.com/automate-boring-stuff-python-3rd-edition" class="calibre6">https://nostarch.com/automate-boring-stuff-python-3rd-edition</a></i>. To return a Pillow <span class="literal">Image</span> object of the clipboard contents, use the <span class="literal">pyperclipimg</span> module’s <span class="literal">paste()</span> function.</p>
<p class="indent">Your program should run in the background. As the user copies images to the clipboard, it should save them to a file with the current timestamp, such as <i class="calibre5">clipboard-2028-12-16 21_58_21.753433.png</i>. A call to <span class="literal">str(datetime.datetime.now())</span> returns this timestamp format, but you must replace the colons with underscores.</p>
<p class="indent">The program should also display <span class="literal">Recording clipboard images... (Ctrl-C to stop)</span> when it starts and <span class="literal">Saved clipboard-2028-12-16 21:58:21.753433.png</span> when it saves a file.</p>
<p class="indent">Save this program in a file named <i class="calibre5">clipboardImgRec.py</i>.<span role="doc-pagebreak" id="calibre_link-2768" aria-label="148"></span></p>
</section>
</section>
</section>
</div>







<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"8bd877e77db3400e83e36e899a2ab1fd","r":1,"server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<style>.atbs-nav{display:flex;flex-wrap:wrap;gap:.5rem;align-items:center;justify-content:space-between;margin:1rem 0;padding:.7rem .8rem;border:1px solid #cfd8dc;border-radius:10px;background:#f6fbfd;font:14px/1.35 system-ui,-apple-system,sans-serif;}.atbs-nav-center{color:#455a64;font-weight:600;}.atbs-nav-link{text-decoration:none;color:#0b5b6b;background:#e6f3f7;border:1px solid #c7dfe7;border-radius:7px;padding:.42rem .55rem;display:inline-block;}.atbs-nav-link:hover{background:#d9edf3;}.atbs-nav-disabled{opacity:.55;cursor:not-allowed;}</style><nav class='atbs-nav' aria-label='Chapter pagination'><a class='atbs-nav-link' href='../book/chapter21.html' aria-label='Previous chapter'>&larr; Book Chapter 21</a><span class='atbs-nav-center'><a class='atbs-nav-link' href='../index.html'>Contents</a> Workbook Chapter 21</span><a class='atbs-nav-link' href='../book/chapter22.html' aria-label='Next chapter'>Book Chapter 22 &rarr;</a></nav></body></html>