<html><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link href="../assets/inventwithpython.com/automate3workbook/style.css" rel="stylesheet" type="text/css" /><title>Automate the Boring Stuff with Python Workbook: Projects and Exercises to Sharpen Your Python Skills</title></head><body><style>.atbs-nav{display:flex;flex-wrap:wrap;gap:.5rem;align-items:center;justify-content:space-between;margin:1rem 0;padding:.7rem .8rem;border:1px solid #cfd8dc;border-radius:10px;background:#f6fbfd;font:14px/1.35 system-ui,-apple-system,sans-serif;}.atbs-nav-center{color:#455a64;font-weight:600;}.atbs-nav-link{text-decoration:none;color:#0b5b6b;background:#e6f3f7;border:1px solid #c7dfe7;border-radius:7px;padding:.42rem .55rem;display:inline-block;}.atbs-nav-link:hover{background:#d9edf3;}.atbs-nav-disabled{opacity:.55;cursor:not-allowed;}</style><nav class='atbs-nav' aria-label='Chapter pagination'><a class='atbs-nav-link' href='../book/chapter22.html' aria-label='Previous chapter'>&larr; Book Chapter 22</a><span class='atbs-nav-center'><a class='atbs-nav-link' href='../index.html'>Contents</a> Workbook Chapter 22</span><a class='atbs-nav-link' href='../book/chapter23.html' aria-label='Next chapter'>Book Chapter 23 &rarr;</a></nav>






<div class="calibre" id="calibre_link-30">
<section type="chapter" role="doc-chapter" aria-labelledby="ch22">
<h1 id="calibre_link-2769" type="title" class="h1ch"><span role="doc-pagebreak" id="calibre_link-2770" aria-label="149" class="calibre1"></span><span class="big">22</span><span class="break1"></span>RECOGNIZING TEXT IN IMAGES</h1>
<p class="noindent-c">While the Pillow package in the previous chapter can easily create images with text, extracting text from images is an advanced topic in computer science. Fortunately, the PyTesseract package handles the details of machine learning and image processing for you. With a small amount of preparation, your programs can convert screenshots and scanned documents into text strings using just a few lines of code.</p>
<aside type="sidebar" class="sidebar" aria-labelledby="side22" role="doc-example">
<section>
<h2 type="title" class="stitle" id="calibre_link-2771"><img class="inline" src="../assets/inventwithpython.com/automate3workbook/images/000000.jpg" alt="A simple drawing of a light bulb." /> LEARNING OBJECTIVES</h2>
<ul class="b-bullet">
<li class="bull">Install the Tesseract OCR engine and the PyTesseract package so that your Python scripts can use it.</li>
<li class="bull">Know the limitations of OCR and the Tesseract engine.</li>
<li class="bull">Enhance your OCR scan with pre-process and post-process techniques.</li>
<li class="bull">Perform OCR in languages other than English.</li>
<li class="bull">Produce PDFs with embedded text from the Tesseract-powered NAPS2 application.</li>
</ul>
</section>
</aside>
<section>
<h2 id="calibre_link-252" type="title" class="h"><span role="doc-pagebreak" id="calibre_link-2772" aria-label="150" class="calibre1"></span><img class="inline" src="../assets/inventwithpython.com/automate3workbook/images/000005.jpg" alt="A grey circle with a white question mark at the center" /> Practice Questions</h2>
<p class="noindent">These questions test your knowledge of PyTesseract and the NAPS2 scanner application.</p>
<section>
<h3 id="calibre_link-253" type="title" class="h1">Installing Tesseract and PyTesseract </h3>
<p class="noindent">To work with PyTesseract, you must install the free Tesseract optical character recognition (OCR) engine software on your Windows, macOS, or Linux computer. You can also choose to install language packs for non-English languages. Then, you must install the PyTesseract package so that your Python scripts can interact with Tesseract.</p>
<ol class="order">
<li class="calibre15"><p class="number"><a href="#calibre_link-1295" id="calibre_link-2427" class="calibre6">1</a>. What is the difference between Tesseract and PyTesseract?</p></li>
<li class="calibre15"><p class="number"><a href="#calibre_link-1296" id="calibre_link-2428" class="calibre6">2</a>. Can your Python scripts do OCR with just PyTesseract installed, and not Tesseract?</p></li>
<li class="calibre15"><p class="number"><a href="#calibre_link-1297" id="calibre_link-2429" class="calibre6">3</a>. What do the <i class="calibre5">eng.traineddata</i> and <i class="calibre5">jpn.traineddata</i> files contain?</p></li>
<li class="calibre15"><p class="number"><a href="#calibre_link-1298" id="calibre_link-2430" class="calibre6">4</a>. Is Tesseract installed in the same way on Windows, macOS, and Linux?</p></li>
</ol>
</section>
<section>
<h3 id="calibre_link-254" type="title" class="h1">OCR Fundamentals</h3>
<p class="noindent">Using PyTesseract and the Pillow image library, you can extract text from an image in four lines of code. OCR has limitations, however, and you need to understand what kinds of images are suitable for it.</p>
<ol class="order">
<li class="calibre15"><p class="number"><a href="#calibre_link-1299" id="calibre_link-2431" class="calibre6">5</a>. Does PyTesseract require Pillow to be installed?</p></li>
<li class="calibre15"><p class="number"><a href="#calibre_link-1300" id="calibre_link-2432" class="calibre6">6</a>. What PyTesseract function takes an <span class="literal">Image</span> object argument and returns a string of the text in that image?</p></li>
<li class="calibre15"><p class="number"><a href="#calibre_link-1301" id="calibre_link-2433" class="calibre6">7</a>. Can PyTesseract identify fonts, font sizes, and font colors?</p></li>
<li class="calibre15"><p class="number"><a href="#calibre_link-1302" id="calibre_link-2434" class="calibre6">8</a>. Can PyTesseract extract text from a scanned document of typed text?</p></li>
<li class="calibre15"><p class="number"><a href="#calibre_link-1303" id="calibre_link-2435" class="calibre6">9</a>. Can PyTesseract extract text from a scanned document of handwritten text?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1304" id="calibre_link-2436" class="calibre6">10</a>. Can PyTesseract extract the text of a license plate from a photo of a car?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1305" id="calibre_link-2437" class="calibre6">11</a>. In general, will PyTesseract preserve the layout of the source text, such as hyphenated words broken across lines?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1306" id="calibre_link-2438" class="calibre6">12</a>. In general, how reliable are LLMs at cleaning up the extracted text from PyTesseract?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1307" id="calibre_link-2439" class="calibre6">13</a>. Can you usually use the spellchecker to identify incorrectly extracted words from PyTesseract?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1308" id="calibre_link-2440" class="calibre6">14</a>. What about to identify incorrectly extracted numbers?</p></li>
</ol>
</section>
<section>
<h3 id="calibre_link-255" type="title" class="h1"><span role="doc-pagebreak" id="calibre_link-2773" aria-label="151" class="calibre1"></span>Recognizing Text in Non-English Languages</h3>
<p class="noindent">Tesseract can extract text in languages other than English if you install additional language packs, then specify the language PyTesseract should recognize.</p>
<ol class="order">
<li class="calibre15"><p class="number1"><a href="#calibre_link-1309" id="calibre_link-2441" class="calibre6">15</a>. Tesseract identifies characters of what language by default?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1310" id="calibre_link-2442" class="calibre6">16</a>. How can you view a list of all the languages that Tesseract supports?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1311" id="calibre_link-2443" class="calibre6">17</a>. What keyword argument would you pass to make the <span class="literal">image_to</span><span class="literal">_string()</span> function recognize Japanese characters?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1312" id="calibre_link-2444" class="calibre6">18</a>. What happens if you don’t pass this keyword argument to <span class="literal">image_to_string()</span> while passing it an image of Japanese characters?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1313" id="calibre_link-2445" class="calibre6">19</a>. What keyword argument would you pass to make the <span class="literal">image_to_string()</span> function recognize English and Japanese characters in the same document?</p></li>
</ol>
</section>
<section>
<h3 id="calibre_link-256" type="title" class="h1">The NAPS2 Scanner Application</h3>
<p class="noindent">A common use case for OCR is creating PDF documents of scanned images with searchable text. Although there are apps to do this, they often don’t offer the flexibility needed to automate PDF generation for hundreds or thousands of images. For tasks like these, you can use the open source Not Another PDF Scanner 2 (NAPS2) application, which runs Tesseract and adds text to PDF documents.</p>
<ol class="order">
<li class="calibre15"><p class="number1"><a href="#calibre_link-1314" id="calibre_link-2446" class="calibre6">20</a>. How much does the NAPS2 app cost?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1315" id="calibre_link-2447" class="calibre6">21</a>. Which operating systems is the NAPS2 app available on?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1316" id="calibre_link-2448" class="calibre6">22</a>. What Python module allows you to run NAPS2 from your Python program?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1317" id="calibre_link-2449" class="calibre6">23</a>. What does the command line flag <span class="literal">-i</span> followed by <span class="literal">frankenstein.png</span> mean to the NAPS2 app?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1318" id="calibre_link-2450" class="calibre6">24</a>. What does the command line flag <span class="literal">-o</span> followed by <span class="literal">output.pdf</span> mean to the NAPS2 app?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1319" id="calibre_link-2451" class="calibre6">25</a>. If you already have the English language pack installed, what does the command line flag <span class="literal">--install</span> followed by <span class="literal">ocr-eng</span> do?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1320" id="calibre_link-2452" class="calibre6">26</a>. What command line flags would you pass to install the Japanese language pack for NAPS2?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1321" id="calibre_link-2453" class="calibre6">27</a>. What does the command line flag <span class="literal">-n</span> followed by <span class="literal">0</span> mean to the NAPS2 app?</p></li>
<li class="calibre15"><p class="number1"><a href="#calibre_link-1322" id="calibre_link-2454" class="calibre6">28</a>. What does the command line flag <span class="literal">-i</span> followed by <span class="literal">page1.png;page2.png</span> mean to the NAPS2 app?</p></li>
</ol>
</section>
</section>
<section>
<h2 id="calibre_link-257" type="title" class="h"><span role="doc-pagebreak" id="calibre_link-2774" aria-label="152" class="calibre1"></span><img class="inline" src="../assets/inventwithpython.com/automate3workbook/images/000002.jpg" alt="A simple drawing of a sharpened pencil." /> Practice Projects</h2>
<p class="noindent">In the following projects, you’ll extract text from a collection of comics in order to search images, and automate resizing images.</p>
<section>
<h3 id="calibre_link-258" type="title" class="h1">Searchable Web Comics</h3>
<p class="noindent">I like to download the images of various web comics and memes I find online. I have a large collection of these&mdash;so large that I have trouble finding specific ones. I can’t do a text search for the contents of images, but I could use PyTesseract to extract the text from the images, then search that text. It won’t be perfect, but it should work most of the time.</p>
<p class="indent">Create a program that runs PyTesseract on every <i class="calibre5">.png</i> image in the current working directory and creates a dictionary that maps the image filename to its extracted text. You can store this dictionary as JSON in a file named <i class="calibre5">imageText.json</i> so that you need to run the extraction program only once. Then, you can open the JSON file in any editor and <span class="smallcaps">ctrl</span>-F for the text you are looking for.</p>
<p class="indent">You can download a selection of images to use from this book’s downloadable contents at <i class="calibre5"><a href="https://nostarch.com/automate-workbook" class="calibre6">https://nostarch.com/automate-workbook</a></i>.</p>
<p class="indent">Save this program in a file named <i class="calibre5">makeImageTextJSON.py</i>.</p>
</section>
<section>
<h3 id="calibre_link-259" type="title" class="h1">Enhancing Text in Web Comics</h3>
<p class="noindent">Let’s extend the program from the previous practice project. Web comic images are usually smaller and simpler than high-resolution photos. Sometimes their text is too small for PyTesseract to accurately recognize. One trick you can try is increasing the size of the web comic image using Pillow and checking if this improves PyTesseract’s text recognition.</p>
<p class="indent">For example, when I run PyTesseract on the original image at <i class="calibre5"><a href="https://xkcd.com/1968/" class="calibre6">https://xkcd.com/1968/</a></i>, it returns the following string:</p>
<pre class="pre">'fo SOMES AD NCED A UELOES SELRQURE\nEROUEE fb OMB, NGREEPARLE PRD REBELS
AGRO\nee HUMAN CONTROL 22\n\n+ &gt;\n\n2\nTHE PART LOTS OF PEOPLE\nSEEM To WORRY
ABOUT\n\nTHE PART I WORRY ABOUT\n\n'</pre>
<p class="indent">If I first use Pillow to double the size of the image and then run PyTesseract, it gives me more accurate results:</p>
<pre class="pre">'Al BECOMES SELF-AWARE\nAND REBELS AGAINST\nHUMAN CONTROL\n\nA\nTHE PART LOTS OF
PEOPLE\nSEEM To WORRY ABOUT\n\nTHE PART I WORRY ABOUT\n\n'</pre>
<p class="indent">Many people misread my name, Al, as the term <i class="calibre5">AI</i>, but PyTesseract seems to make the opposite mistake in this case. Your machine may produce slightly different text based on the PyTesseract version used.</p>
<p class="indent">Create an updated version of the program from the previous practice project that automatically resizes the image to twice the original width and height and then performs OCR on the enlarged image. Save the dictionary mapping the enlarged filenames to the extracted text as JSON in a file named <i class="calibre5">imageTextEnlarged.json</i>. Compare the accuracy of the text in this file with that of the text in <i class="calibre5">imageText.json</i> from the previous project.</p>
<p class="indent">Save this program in a file named <i class="calibre5">makeImageTextEnlargedJSON.py</i>.</p>
</section>
</section>
</section>
</div>







<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"8bd877e77db3400e83e36e899a2ab1fd","r":1,"server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<style>.atbs-nav{display:flex;flex-wrap:wrap;gap:.5rem;align-items:center;justify-content:space-between;margin:1rem 0;padding:.7rem .8rem;border:1px solid #cfd8dc;border-radius:10px;background:#f6fbfd;font:14px/1.35 system-ui,-apple-system,sans-serif;}.atbs-nav-center{color:#455a64;font-weight:600;}.atbs-nav-link{text-decoration:none;color:#0b5b6b;background:#e6f3f7;border:1px solid #c7dfe7;border-radius:7px;padding:.42rem .55rem;display:inline-block;}.atbs-nav-link:hover{background:#d9edf3;}.atbs-nav-disabled{opacity:.55;cursor:not-allowed;}</style><nav class='atbs-nav' aria-label='Chapter pagination'><a class='atbs-nav-link' href='../book/chapter22.html' aria-label='Previous chapter'>&larr; Book Chapter 22</a><span class='atbs-nav-center'><a class='atbs-nav-link' href='../index.html'>Contents</a> Workbook Chapter 22</span><a class='atbs-nav-link' href='../book/chapter23.html' aria-label='Next chapter'>Book Chapter 23 &rarr;</a></nav></body></html>